name: Build Zigbee Firmware

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest
    # We use the official Nordic SDK Docker image (contains toolchain, west, zephyr)
    container:
      image: nordicplayground/nrfconnect-sdk:v2.6-branch

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          path: my-app

      - name: Initialize West (Project Manager)
        # We initialize a new workspace and add our repo as the application
        run: |
          west init -l my-app
          west update

      - name: Build Firmware
        # -b nice_nano_v2 : Specifies the board (SuperMini clone)
        # -s my-app       : Specifies where the source code is
        run: |
          west build -b nice_nano_v2 -s my-app -p

      - name: Archive Firmware
        uses: actions/upload-artifact@v4
        with:
          name: nrf52840_zigbee_firmware
          path: |
            build/zephyr/zephyr.hex
            build/zephyr/zephyr.uf2